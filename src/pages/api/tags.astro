---
import { getCollection } from "astro:content";
import { LinkCard } from "@astrojs/starlight/components";

export const prerender = false;
export const partial = true;

const tagsParam = Astro.url.searchParams.get("tags");

let resources = [];
if (tagsParam) {
  const tags = tagsParam.split(",");
  resources = await getCollection("resources", ({ data }) => {
    if (!data.tags) {
      return false;
    }

    return data.tags.some((tag) => tags.includes(tag));
  });
} else {
  resources = await getCollection("resources");
}
---

{
  resources.map((r) => (
    <LinkCard
      title={r.data.title}
      description={r.data.description ?? ""}
      href={r.data.link}
    />
  ))
}
