---
import type { Props } from '@astrojs/starlight/props'
import Default from '@astrojs/starlight/components/MarkdownContent.astro'
import { Aside } from '@astrojs/starlight/components'
import { minVersion, satisfies } from 'semver'
import pkg from 'package.json'

const { astroRange } = Astro.props.entry.data
const astroVersion = minVersion(pkg.dependencies.astro)?.version
const outRange = astroRange && astroVersion && !satisfies(astroVersion, astroRange)
---

{
	// only show if the range is specified, and is not satisfied by the latest version
	outRange && (
		<Aside type="caution">
			This guide was written for Astro {astroRange} and may not work
			with more recent versions of Astro.
		</Aside>
	)
}

<Default {...Astro.props}><slot /></Default>
